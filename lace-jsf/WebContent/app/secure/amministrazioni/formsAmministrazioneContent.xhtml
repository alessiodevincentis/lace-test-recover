<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:p="http://primefaces.org/ui">
      
	<div class="card card-w-title">
       <h1>Amministrazione</h1>
       
       <h:outputScript library="js" name="formsAmministrazioneAutocomplete.js"/>

         <p:panelGrid columns="3" layout="grid" id="amministrazionePanelGrid"
         styleClass="ui-panelgrid-blank form-group">           

           <p:outputLabel value="Codice Amministrazione:">
               <p:inputText id="codice"
                            value="#{amministrazioneView.amministrazioneViewModel.codiceAmm}"
                            readonly="true"/>
           </p:outputLabel>

           <p:outputLabel value="Ragione Sociale: *">
               <p:inputText id="ragionesociale"
                            value="#{amministrazioneView.amministrazioneViewModel.ragioneSociale}"
                            required="true" maxlength="85" label="Ragione Sociale">
                   <p:ajax event="change" update="schedaATC"/>
               </p:inputText>
           </p:outputLabel>

           <p:outputLabel value="P.IVA: *">
               <p:inputText id="piva" value="#{amministrazioneView.amministrazioneViewModel.piva}"
                            required="true" label="P.IVA">
                   <p:ajax event="change" update="schedaATC"/>
               </p:inputText>
           </p:outputLabel>

           <p:outputLabel value="Codice Fiscale: *">
               <p:inputText id="codiceFiscale"
                            value="#{amministrazioneView.amministrazioneViewModel.codiceFiscale}"
                            required="true" label="Codice Fiscale">
                   <p:ajax event="change" update="schedaATC"/>
               </p:inputText>
           </p:outputLabel>


           <p:panelGrid columns="5" layout="grid">
               <p:outputLabel value="Operazioni Accettate:"/>
               <p:selectBooleanCheckbox id="cqs"
                                        value="#{amministrazioneView.amministrazioneViewModel.cqs}"
                                        itemLabel="CQS"/>
               <p:selectBooleanCheckbox id="dlg"
                                        value="#{amministrazioneView.amministrazioneViewModel.dlg}"
                                        itemLabel="DLG"/>
           </p:panelGrid>

           <p:outputLabel value="Indirizzo Sede Legale:">
               <p:inputText id="indirizzosedelegale"
                            value="#{amministrazioneView.amministrazioneViewModel.indirizzoSedeLegale}"/>
           </p:outputLabel>
           
           <p:outputLabel value="Civico Sede Legale:">
               <p:inputText id="civicosedelegale"
                            value="#{amministrazioneView.amministrazioneViewModel.civicoSedeLegale}"/>
           </p:outputLabel>
           
           <p:outputLabel value="Comune Sede Legale:">
               <p:inputText id="luogosedelegale"
                            value="#{amministrazioneView.amministrazioneViewModel.luogoSedeLegale}"/>
           </p:outputLabel>
         
           <p:outputLabel value="Provincia Sede Legale:">
               <p:inputText id="provsedelegale"
                            value="#{amministrazioneView.amministrazioneViewModel.provSedeLegale}" maxlength="2"/>
           </p:outputLabel>
           
           <p:outputLabel value="CAP Sede Legale:">
               <p:inputText id="capsedelegale"
                            value="#{amministrazioneView.amministrazioneViewModel.capSedeLegale}"/>
           </p:outputLabel>
           
            <p:outputLabel value="Nazione Sede Legale:">
               <p:inputText id="nazionesedelegale"
                            value="#{amministrazioneView.amministrazioneViewModel.nazioneSedeLegale}"/>
           </p:outputLabel>                                      

           <p:outputLabel value="Indirizzo Sede Notifica:">
               <p:inputText id="indirizzosedenotifica"
                            value="#{amministrazioneView.amministrazioneViewModel.indirizzoSedeNotifica}"
                            maxlength="85"/>
           </p:outputLabel>
           
           <p:outputLabel value="Civico Sede Notifica:">
               <p:inputText id="civicosedenotifica"
                            value="#{amministrazioneView.amministrazioneViewModel.civicoSedeNotifica}"/>
           </p:outputLabel>
           
           <p:outputLabel value="Comune Sede Notifica:">
               <p:inputText id="luogosedenotifica"
                            value="#{amministrazioneView.amministrazioneViewModel.luogoSedeNotifica}"/>
           </p:outputLabel>
         
           <p:outputLabel value="Provincia Sede Notifica:">
               <p:inputText id="provsedenotifica"
                            value="#{amministrazioneView.amministrazioneViewModel.provSedeNotifica}" maxlength="2"/>
           </p:outputLabel>
           
           <p:outputLabel value="CAP Sede Notifica:">
               <p:inputText id="capsedenotifica"
                            value="#{amministrazioneView.amministrazioneViewModel.capSedeNotifica}"/>
           </p:outputLabel>
           
            <p:outputLabel value="Nazione Sede Notifica:">
               <p:inputText id="nazionesedenotifica"
                            value="#{amministrazioneView.amministrazioneViewModel.nazioneSedeNotifica}"/>
           </p:outputLabel>             

           <p:panelGrid columns="2" styleClass="ui-panelgrid-blank">
               <p:outputLabel value="Notifica PEC:"/>
               <p:inputSwitch onLabel="Si" offLabel="No"
                              value="#{amministrazioneView.amministrazioneViewModel.notificaPec}">
                   <p:ajax event="change" update="indirizzopec"/>
               </p:inputSwitch>
           </p:panelGrid>


           <p:outputLabel value="Indirizzo PEC:">
               <p:inputText id="indirizzopec"
                            value="#{amministrazioneView.amministrazioneViewModel.indirizzoPec}"
                            disabled="#{!amministrazioneView.amministrazioneViewModel.notificaPec}"/>
           </p:outputLabel>

           <p:outputLabel value="Referente:">
               <p:inputText id="referente"
                            value="#{amministrazioneView.amministrazioneViewModel.referente}"/>
           </p:outputLabel>

           <p:outputLabel value="Ruolo in Azienda:">
               <p:inputText id="ruolo" value="#{amministrazioneView.amministrazioneViewModel.ruolo}"/>
           </p:outputLabel>

           <p:outputLabel value="Telefono:">
               <p:inputText id="telefonoamministrazione"
                            value="#{amministrazioneView.amministrazioneViewModel.telefono}"/>
           </p:outputLabel>

           <p:outputLabel value="Fax:">
               <p:inputText id="faxamministrazione"
                            value="#{amministrazioneView.amministrazioneViewModel.fax}"/>
           </p:outputLabel>

           <p:outputLabel value="Email:">
               <p:inputText id="emailamministrazione"
                            value="#{amministrazioneView.amministrazioneViewModel.email}"
                            validatorMessage="Email non valida">
                   <f:validateRegex
                           pattern="^[_A-Za-z0-9-\+]+(\.[_A-Za-z0-9-]+)*@[A-Za-z0-9-]+(\.[A-Za-z0-9]+)*(\.[A-Za-z]{2,})$"/>
               </p:inputText>
           </p:outputLabel>

            <p:inputTextarea id="noteamministrazione"
                             placeholder="Eventuali Note Aggiuntive sull'Amministrazione"
                             rows="5" cols="43"
                             value="#{amministrazioneView.amministrazioneViewModel.note}"
                             maxlength="160" autoResize="false">
            </p:inputTextarea>
		 </p:panelGrid>
		</div> 

			<div class="card card-w-title">
                <h1>Valutazione</h1>
                <p:outputPanel id="groupValutazione">
                    <p:repeat var="valutazioneAmministrazione"
                              value="#{amministrazioneView.amministrazioneViewModel.valutazioneAmministrazioneViewModelList}">
                                     
						<p:panelGrid columns="4" layout="grid" id="panelValutazioni"
        				 styleClass="ui-panelgrid-blank form-group">

                             <p:outputLabel value="Compagnia: *">
                                <p:selectOneMenu effect="fold" id="compagnie"
                                                 value="#{valutazioneAmministrazione.compagnia}"
                                                 editable="true" label="Compagnia" required="true">

                                    <f:selectItems value="#{constantResolverView.compagnie}" var="c"
                                                   itemLabel="#{c.value}" itemValue="#{c.value}"/>
                                </p:selectOneMenu>
                            </p:outputLabel>

                             <p:outputLabel value="Valutazione: *">
                                <p:selectOneMenu effect="fold" id="valutazioni"
                                                 value="#{valutazioneAmministrazione.valutazione}"
                                                 editable="true" label="Valutazione" required="true">

                                    <f:selectItems value="#{constantResolverView.valutazioni}" var="v"
                                                   itemLabel="#{v.value}" itemValue="#{v.value}"/>
                                </p:selectOneMenu>
                            </p:outputLabel>


                            <p:outputLabel value="Data Valutazione:">
                                <p:calendar value="#{valutazioneAmministrazione.dataValutazione}" mask="true"
                                            pattern="dd/MM/yyyy"/>
                            </p:outputLabel>

                               <p:inputTextarea id="infoaggiuntive"
                                                placeholder="Eventuali info Aggiuntive"
                                                rows="2" cols="1" addLine="true"
                                                value="#{valutazioneAmministrazione.infoAggiuntive}"
                                                maxlength="160">
                               </p:inputTextarea>
                            
                            <p:commandButton update="form:groupValutazione"
                                             action="#{amministrazioneView.removeValutazioneAction(valutazioneAmministrazione)}"
                                             icon="fa fa-remove Fs20 White" iconPos="right"
                                             styleClass="red-btn" immediate="true">
                                <p:confirm header="Confirmation"
                                           message="Eliminare Definitivamente il Criterio di Valutazione?"
                                           icon="ui-icon-alert"/>
                            </p:commandButton>                            


                            <p:confirmDialog global="true" showEffect="fade" hideEffect="fade"
                                             closable="true">
                                <p:commandButton value="Si" type="button" styleClass="ui-confirmdialog-yes"
                                                 icon="ui-icon-check"/>
                                <p:commandButton value="No" type="button" styleClass="ui-confirmdialog-no"
                                                 icon="ui-icon-close"/>
                            </p:confirmDialog>

                        </p:panelGrid>
                        <hr/>
                    </p:repeat>

                    <p:commandButton action="#{amministrazioneView.addValutazioneAction()}" process="groupValutazione"
                                     update="groupValutazione"
                                     icon="fa fa-plus Fs20 White" iconPos="right"
                                     styleClass="green-btn"
                                     disabled="#{amministrazioneView.isMaxLimitValutazioni()}"/>
                </p:outputPanel>
            </div>


		<div class="card card-w-title">
		<p:panelGrid columns="3" layout="grid" styleClass="ui-panelgrid-blank form-group">
            <p:commandButton value="Salva Amministrazione" rendered="#{amministrazioneView.isAmministrazioneButtonRendered()}"
                             update="amministrazionePanelGrid groupValutazione"
                             icon="fa fa-save Fs20 White"
                             action="#{amministrazioneView.saveNewAmministrazione}" process="@this amministrazionePanelGrid groupValutazione finanziariaAmministrazione"
                             iconPos="right" styleClass="red-btn" oncomplete="initializeFormsAmministrazioneAutocomplete()"/>

            <p:outputPanel id="schedaATCTooltip">
                <p:commandButton value="Scheda ATC" id="schedaATC"
                                 action="#{amministrazioneView.printPdfAmministration}" process="@this amministrazionePanelGrid groupValutazione finanziariaAmministrazione"
                                 icon="fa fa-file-text Fs20 White" iconPos="right"
                                 styleClass="orange-btn"
                                 disabled="#{amministrazioneView.isDisabledButtonPdf()}"/>
            </p:outputPanel>


            <p:tooltip for="schedaATCTooltip"
                       value="#{propertiesUtil.msgFunctionalityNotEnabledFull}"
                       position="top" showEffect="clip" hideEffect="clip"
                       rendered="#{amministrazioneView.isPrintPdfDisabled()}"/>


    <p:selectOneMenu effect="fold" id="finanziariaAmministrazione"
                     value="#{amministrazioneView.selectedFinanziariaViewModel}"
                     converter="finanziariaConverter">
        <f:selectItems value="#{amministrazioneView.finanziariaList}"
                       var="finanziaria"
                       itemLabel="#{finanziaria.name}" itemValue="#{finanziaria}"/>

    </p:selectOneMenu>
    </p:panelGrid>
    </div>

</html>       
